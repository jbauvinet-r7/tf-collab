#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
#                                                                                                                                                                               #
#                                                                Welcome to the Rapid7 Global Lab Terraform                                                                     #
#                            Created by : Jean-Baptiste AUVINET                          Version : 1                          Date : 04/08/2024                                 #
#                                                                       Rapid7 Subnet OUtputs Definitions                                                                       #
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
#  Traffic Mirroring                                                                                                                                                                                                            
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
############# Mirror Target #############
output "traffic_mirror_target_id" {
  value = one(module.traffic_mirroring[*].traffic_mirror_target_id)
}

############# Mirror Filter #############
output "traffic_mirror_filter_id" {
  value = one(module.traffic_mirroring[*].traffic_mirror_filter_id)
}

############# Traffic NIC #############
output "traffic_nic_id" {
  value = one(module.compute_NSENSOR[*].traffic_nic_id)
}

############# Traffic Instance #############
output "traffic_instance" {
  value = one(module.compute_NSENSOR[*].traffic_instance)
}

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
#  Security Group                                                                                                                                                                                             
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
output "aws_security_group_nlb_id" {
  value = one(module.traffic_mirroring[*].aws_security_group_nlb_id)
}
